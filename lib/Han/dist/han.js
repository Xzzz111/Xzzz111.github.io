void function(e,n){if(typeof module==="object"&&typeof module.exports==="object"){module.exports=n(e,true)}else if(typeof define==="function"&&define.amd){define(function(){return n(e,true)})}else{n(e)}}(typeof window!=="undefined"?window:this,function(s,e){"use strict";var d=s.document;var u=d.documentElement;var l=d.body;var n="3.3.0";var H=["initCond","renderElem","renderJiya","renderHanging","correctBiaodian","renderHWS","substCombLigaWithPUA"];var o=function(e,n){return new o.fn.init(e,n)};var O=function(){if(arguments[0]){this.context=arguments[0]}if(arguments[1]){this.condition=arguments[1]}return this};o.version=n;o.fn=o.prototype={version:n,constructor:o,context:l,condition:u,routine:H,init:O,setRoutine:function(e){if(Array.isArray(e)){this.routine=e}return this},render:function(e){var n=this;var e=Array.isArray(e)?e:this.routine;e.forEach(function(e){if(typeof e==="string"&&typeof n[e]==="function"){n[e]()}else if(Array.isArray(e)&&typeof n[e[0]]==="function"){n[e.shift()].apply(n,e)}});return this}};o.fn.init.prototype=o.fn;o.init=function(){return o.init=o().render()};var M={punct:{base:"[…,.;:!?‽_]",sing:"[‐-—…]",middle:"[\\/~\\-&‐-—_]",open:"['\"‘“\\(\\[¡¿⸘«‹‚“„]",close:"['\"”’\\)\\]»›‛”‟]",end:"['\"”’\\)\\]»›‛”‟‼‽⁇-⁉,.;:!?]"},biaodian:{base:"[︰．、，。：；？！ー]",liga:"[—…⋯]",middle:"[·＼／－゠＆・＿]",open:"[「『《〈（〔［｛【〖]",close:"[」』》〉）〕］｝】〗]",end:"[」』》〉）〕］｝】〗︰．、，。：；？！ー]"},hanzi:{base:"[一-鿿㐀-䶵㇀-㇣〇﨎﨏﨑﨓﨔﨟﨡﨣﨤﨧-﨩]|[\ud800-\udbff][\udc00-\udfff]",desc:"[⿰-⿺]",radical:"[⼀-⿕⺀-⻳]"},latin:{base:"[A-Za-z0-9À-ÿĀ-ſƀ-ɏⱠ-Ɀ꜠-ꟿḀ-ỿ]",combine:"[̀-́᷀-᷿]"},ellinika:{base:"[0-9Ͱ-Ͽἀ-῿]",combine:"[̀-᷀ͅ-᷿]"},kirillica:{base:"[0-9Ѐ-҂Ҋ-ӿԀ-ԯꙀ-ꙮ꙾-ꚗ]",combine:"[҃-҉ⷠ-ⷿ꙯-꙽ꚟ]"},kana:{base:"[アイウエオ-ヺあいうえお-ゔゟヿ]|\ud82c[\udc00-\udc01]",small:"[ぁぃぅぇぉァィゥェォっゃゅょゎゕゖッャュョヮヵヶㇰ-ㇿ]",combine:"[゙-゜]",half:"[ｦ-ﾟ]",mark:"[゠ゝゞ・-ヾ]"},eonmun:{base:"[가-힣]",letter:"[ᄀ-ᇿㅏ-ㅣㄱ-ㆎꥠ-ꥼힰ-ퟻ]",half:"[ﾡ-ￜ]"},zhuyin:{base:"[ㄅ-ㄭㆠ-ㆺ]",initial:"[ㄅ-ㄙㄪ-ㄬㆠ-ㆣ]",medial:"[ㄧ-ㄩ]",final:"[ㄚ-ㄩㄭㆤ-ㆳㆸ-ㆺ]",tone:"[˙ˊ˅ˇˋ˪˫]",checked:"[ㆴ-ㆷ][̍͘]?"}};var a=function(){var e="[\\x20\\t\\r\\n\\f]";var n=M.punct.open;var t=M.punct.close;var r=M.punct.end;var i=M.punct.middle;var a=M.punct.sing;var o=n+"|"+r+"|"+i;var c=M.biaodian.open;var s=M.biaodian.close;var u=M.biaodian.end;var d=M.biaodian.middle;var l=M.biaodian.liga+"{2}";var h=c+"|"+u+"|"+d;var f=M.kana.base+M.kana.combine+"?";var p=M.kana.small+M.kana.combine+"?";var v=M.kana.half;var g=M.eonmun.base+"|"+M.eonmun.letter;var b=M.eonmun.half;var m=M.hanzi.base+"|"+M.hanzi.desc+"|"+M.hanzi.radical+"|"+f;var y=M.ellinika.combine;var x=M.latin.base+y+"*";var E=M.ellinika.base+y+"*";var w=M.kirillica.combine;var N=M.kirillica.base+w+"*";var C=x+"|"+E+"|"+N;var T="['’]";var S=m+"|(?:"+C+"|"+T+")+";var L=M.zhuyin.initial;var k=M.zhuyin.medial;var z=M.zhuyin.final;var I=M.zhuyin.tone+"|"+M.zhuyin.checked;return{char:{punct:{all:new RegExp("("+o+")","g"),open:new RegExp("("+n+")","g"),end:new RegExp("("+r+")","g"),sing:new RegExp("("+a+")","g")},biaodian:{all:new RegExp("("+h+")","g"),open:new RegExp("("+c+")","g"),close:new RegExp("("+s+")","g"),end:new RegExp("("+u+")","g"),liga:new RegExp("("+l+")","g")},hanzi:new RegExp("("+m+")","g"),latin:new RegExp("("+x+")","ig"),ellinika:new RegExp("("+E+")","ig"),kirillica:new RegExp("("+N+")","ig"),kana:new RegExp("("+f+"|"+p+"|"+v+")","g"),eonmun:new RegExp("("+g+"|"+b+")","g")},group:{biaodian:[new RegExp("(("+h+"){2,})","g"),new RegExp("("+l+c+")","g")],punct:null,hanzi:new RegExp("("+m+")+","g"),western:new RegExp("("+x+"|"+E+"|"+N+"|"+o+")+","ig"),kana:new RegExp("("+f+"|"+p+"|"+v+")+","g"),eonmun:new RegExp("("+g+"|"+b+"|"+o+")+","g")},jinze:{hanging:new RegExp(e+"*([、，。．])(?!"+u+")","ig"),touwei:new RegExp("("+c+"+)("+S+")("+u+"+)","ig"),tou:new RegExp("("+c+"+)("+S+")","ig"),wei:new RegExp("("+S+")("+u+"+)","ig"),middle:new RegExp("("+S+")("+d+")("+S+")","ig")},zhuyin:{form:new RegExp("^˙?("+L+")?("+k+")?("+z+")?("+I+")?$"),diao:new RegExp("("+I+")","g")},hws:{base:[new RegExp("("+m+")("+C+"|"+n+")","ig"),new RegExp("("+C+"|"+r+")("+m+")","ig")],strict:[new RegExp("("+m+")"+e+"?("+C+"|"+n+")","ig"),new RegExp("("+C+"|"+r+")"+e+"?("+m+")","ig")]},"display-as":{"ja-font-for-hant":["查 査","啟 啓","鄉 鄕","值 値","污 汚"],"comb-liga-pua":[["a[̍͘]","󰁡"],["e[̍͘]","󰁥"],["i[̍͘]","󰁩"],["o[̍͘]","󰁯"],["u[̍͘]","󰁵"],["ㆴ[̍͘]","󳆴"],["ㆵ[̍͘]","󳆵"],["ㆶ[̍͘]","󳆶"],["ㆷ[̍͘]","󳆷"]],"comb-liga-vowel":[["a[̍͘]","󰁡"],["e[̍͘]","󰁥"],["i[̍͘]","󰁩"],["o[̍͘]","󰁯"],["u[̍͘]","󰁵"]],"comb-liga-zhuyin":[["ㆴ[̍͘]","󳆴"],["ㆵ[̍͘]","󳆵"],["ㆶ[̍͘]","󳆶"],["ㆷ[̍͘]","󳆷"]]},"inaccurate-char":[["[•‧]","·"],["⋯⋯","……"],["──","——"],["‵","‘"],["′","’"],["‶","“"],["″","”"]]}}();o.UNICODE=M;o.TYPESET=a;o.UNICODE.cjk=o.UNICODE.hanzi;o.UNICODE.greek=o.UNICODE.ellinika;o.UNICODE.cyrillic=o.UNICODE.kirillica;o.UNICODE.hangul=o.UNICODE.eonmun;o.UNICODE.zhuyin.ruyun=o.UNICODE.zhuyin.checked;o.TYPESET.char.cjk=o.TYPESET.char.hanzi;o.TYPESET.char.greek=o.TYPESET.char.ellinika;o.TYPESET.char.cyrillic=o.TYPESET.char.kirillica;o.TYPESET.char.hangul=o.TYPESET.char.eonmun;o.TYPESET.group.hangul=o.TYPESET.group.eonmun;o.TYPESET.group.cjk=o.TYPESET.group.hanzi;var h={id:function(e,n){return(n||d).getElementById(e)},tag:function(e,n){return this.makeArray((n||d).getElementsByTagName(e))},qs:function(e,n){return(n||d).querySelector(e)},qsa:function(e,n){return this.makeArray((n||d).querySelectorAll(e))},parent:function(e,n){return n?function(){if(typeof h.matches!=="function")return;while(!h.matches(e,n)){if(!e||e===d.documentElement){e=undefined;break}e=e.parentNode}return e}():e?e.parentNode:undefined},create:function(e,n){var t="!"===e?d.createDocumentFragment():""===e?d.createTextNode(n||""):d.createElement(e);try{if(n){t.className=n}}catch(e){}return t},clone:function(e,n){return e.cloneNode(typeof n==="boolean"?n:true)},remove:function(e){return e.parentNode.removeChild(e)},setAttr:function(e,n){if(typeof n!=="object")return;var t=n.length;if(typeof n[0]==="object"&&"name"in n[0]){for(var r=0;r<t;r++){if(n[r].value!==undefined){e.setAttribute(n[r].name,n[r].value)}}}else{for(var i in n){if(n.hasOwnProperty(i)&&n[i]!==undefined){e.setAttribute(i,n[i])}}}return e},isElmt:function(e){return e&&e.nodeType===Node.ELEMENT_NODE},isIgnorable:function(e){if(!e)return false;return e.nodeName==="WBR"||e.nodeType===Node.COMMENT_NODE},makeArray:function(e){return Array.prototype.slice.call(e)},extend:function(e,n){if((typeof e==="object"||typeof e==="function")&&typeof n==="object"){for(var t in n){if(n.hasOwnProperty(t)){e[t]=n[t]}}}return e}};var t=function(r){"use strict";var e="0.2.1";var i=r.NON_INLINE_PROSE;var a=r.PRESETS.prose.filterElements;var n=s||{};var t=n.document||undefined;function o(e,n,t){var r=Element.prototype;var i=r.matches||r.mozMatchesSelector||r.msMatchesSelector||r.webkitMatchesSelector;if(e instanceof Element){return i.call(e,n)}else if(t){if(/^[39]$/.test(e.nodeType))return true}return false}if(typeof t==="undefined")throw new Error("Fibre requires a DOM-supported environment.");var c=function(e,n){return new c.fn.init(e,n)};c.version=e;c.matches=o;c.fn=c.prototype={constructor:c,version:e,finder:[],context:undefined,portionMode:"retain",selector:{},preset:"prose",init:function(e,n){if(!!n)this.preset=null;this.selector={context:null,filter:[],avoid:[],boundary:[]};if(!e){throw new Error("A context is required for Fibre to initialise.")}else if(e instanceof Node){if(e instanceof Document)this.context=e.body||e;else this.context=e}else if(typeof e==="string"){this.context=t.querySelector(e);this.selector.context=e}return this},filterFn:function(e){var n=this.selector.filter.join(", ")||"*";var t=this.selector.avoid.join(", ")||null;var r=o(e,n,true)&&!o(e,t);return this.preset==="prose"?a(e)&&r:r},boundaryFn:function(e){var n=this.selector.boundary.join(", ")||null;var t=o(e,n);return this.preset==="prose"?i(e)||t:t},filter:function(e){if(typeof e==="string"){this.selector.filter.push(e)}return this},endFilter:function(e){if(e){this.selector.filter=[]}else{this.selector.filter.pop()}return this},avoid:function(e){if(typeof e==="string"){this.selector.avoid.push(e)}return this},endAvoid:function(e){if(e){this.selector.avoid=[]}else{this.selector.avoid.pop()}return this},addBoundary:function(e){if(typeof e==="string"){this.selector.boundary.push(e)}return this},removeBoundary:function(){this.selector.boundary=[];return this},setMode:function(e){this.portionMode=e==="first"?"first":"retain";return this},replace:function(e,n){var t=this;t.finder.push(r(t.context,{find:e,replace:n,filterElements:function(e){return t.filterFn(e)},forceContext:function(e){return t.boundaryFn(e)},portionMode:t.portionMode}));return t},wrap:function(e,n){var t=this;t.finder.push(r(t.context,{find:e,wrap:n,filterElements:function(e){return t.filterFn(e)},forceContext:function(e){return t.boundaryFn(e)},portionMode:t.portionMode}));return t},revert:function(e){var n=this.finder.length;var e=Number(e)||(e===0?Number(0):e==="all"?n:1);if(typeof n==="undefined"||n===0)return this;else if(e>n)e=n;for(var t=e;t>0;t--){this.finder.pop().revert()}return this}};c.fn.filterOut=c.fn.avoid;c.fn.init.prototype=c.fn;return c}(function(){var i="retain";var a="first";var b=d;var n={}.toString;var o={}.hasOwnProperty;function e(e){return n.call(e)=="[object Array]"}function t(e){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function c(){return r.apply(null,arguments)||s.apply(null,arguments)}function r(e,n,t,r,i){if(n&&!n.nodeType&&arguments.length<=2){return false}var a=typeof t=="function";if(a){t=function(t){return function(e,n){return t(e.text,n.startIndex)}}(t)}var o=s(n,{find:e,wrap:a?null:t,replace:a?t:"$"+(r||"&"),prepMatch:function(e,n){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(r>0){var t=e[r];e.index+=e[0].indexOf(t);e[0]=t}e.endIndex=e.index+e[0].length;e.startIndex=e.index;e.index=n;return e},filterElements:i});c.revert=function(){return o.revert()};return true}function s(e,n){return new u(e,n)}c.NON_PROSE_ELEMENTS={br:1,hr:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1};c.NON_CONTIGUOUS_PROSE_ELEMENTS={address:1,article:1,aside:1,blockquote:1,dd:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,nav:1,noscript:1,ol:1,output:1,p:1,pre:1,section:1,ul:1,br:1,li:1,summary:1,dt:1,details:1,rp:1,rt:1,rtc:1,script:1,style:1,img:1,video:1,audio:1,canvas:1,svg:1,map:1,object:1,input:1,textarea:1,select:1,option:1,optgroup:1,button:1,table:1,tbody:1,thead:1,th:1,tr:1,td:1,caption:1,col:1,tfoot:1,colgroup:1};c.NON_INLINE_PROSE=function(e){return o.call(c.NON_CONTIGUOUS_PROSE_ELEMENTS,e.nodeName.toLowerCase())};c.PRESETS={prose:{forceContext:c.NON_INLINE_PROSE,filterElements:function(e){return!o.call(c.NON_PROSE_ELEMENTS,e.nodeName.toLowerCase())}}};c.Finder=u;function u(e,n){var t=n.preset&&c.PRESETS[n.preset];n.portionMode=n.portionMode||i;if(t){for(var r in t){if(o.call(t,r)&&!o.call(n,r)){n[r]=t[r]}}}this.node=e;this.options=n;this.prepMatch=n.prepMatch||this.prepMatch;this.reverts=[];this.matches=this.search();if(this.matches.length){this.processMatches()}}u.prototype={search:function(){var i;var a=0;var o=0;var c=this.options.find;var e=this.getAggregateText();var s=[];var u=this;c=typeof c==="string"?RegExp(t(c),"g"):c;d(e);function d(e){for(var n=0,t=e.length;n<t;++n){var r=e[n];if(typeof r!=="string"){d(r);continue}if(c.global){while(i=c.exec(r)){s.push(u.prepMatch(i,a++,o))}}else{if(i=r.match(c)){s.push(u.prepMatch(i,0,o))}}o+=r.length}}return s},prepMatch:function(e,n,t){if(!e[0]){throw new Error("findAndReplaceDOMText cannot handle zero-length matches")}e.endIndex=t+e.index+e[0].length;e.startIndex=t+e.index;e.index=n;return e},getAggregateText:function(){var i=this.options.filterElements;var a=this.options.forceContext;return o(this.node);function o(e,n){if(e.nodeType===3){return[e.data]}if(i&&!i(e)){return[]}var n=[""];var t=0;if(e=e.firstChild)do{if(e.nodeType===3){n[t]+=e.data;continue}var r=o(e);if(a&&e.nodeType===1&&(a===true||a(e))){n[++t]=r;n[++t]=""}else{if(typeof r[0]==="string"){n[t]+=r.shift()}if(r.length){n[++t]=r;n[++t]=""}}}while(e=e.nextSibling);return n}},processMatches:function(){var e=this.matches;var n=this.node;var t=this.options.filterElements;var r,i,a=[],o=n,c=e.shift(),s=0,u=0,d=0,l,h=[n];e:while(true){if(o.nodeType===3){if(!i&&o.length+s>=c.endIndex){i={node:o,index:d++,text:o.data.substring(c.startIndex-s,c.endIndex-s),indexInMatch:s-c.startIndex,indexInNode:c.startIndex-s,endIndexInNode:c.endIndex-s,isEnd:true}}else if(r){a.push({node:o,index:d++,text:o.data,indexInMatch:s-c.startIndex,indexInNode:0})}if(!r&&o.length+s>c.startIndex){r={node:o,index:d++,indexInMatch:0,indexInNode:c.startIndex-s,endIndexInNode:c.endIndex-s,text:o.data.substring(c.startIndex-s,c.endIndex-s)}}s+=o.data.length}l=o.nodeType===1&&t&&!t(o);if(r&&i){o=this.replaceMatch(c,r,a,i);s-=i.node.data.length-i.endIndexInNode;r=null;i=null;a=[];c=e.shift();d=0;u++;if(!c){break}}else if(!l&&(o.firstChild||o.nextSibling)){if(o.firstChild){h.push(o);o=o.firstChild}else{o=o.nextSibling}continue}while(true){if(o.nextSibling){o=o.nextSibling;break}o=h.pop();if(o===n){break e}}}},revert:function(){for(var e=this.reverts.length;e--;){this.reverts[e]()}this.reverts=[]},prepareReplacementString:function(e,n,r,t){var i=this.options.portionMode;if(i===a&&n.indexInMatch>0){return""}e=e.replace(/\$(\d+|&|`|')/g,function(e,n){var t;switch(n){case"&":t=r[0];break;case"`":t=r.input.substring(0,r.startIndex);break;case"'":t=r.input.substring(r.endIndex);break;default:t=r[+n]}return t});if(i===a){return e}if(n.isEnd){return e.substring(n.indexInMatch)}return e.substring(n.indexInMatch,n.indexInMatch+n.text.length)},getPortionReplacementNode:function(e,n,t){var r=this.options.replace||"$&";var i=this.options.wrap;if(i&&i.nodeType){var a=b.createElement("div");a.innerHTML=i.outerHTML||(new XMLSerializer).serializeToString(i);i=a.firstChild}if(typeof r=="function"){r=r(e,n,t);if(r&&r.nodeType){return r}return b.createTextNode(String(r))}var o=typeof i=="string"?b.createElement(i):i;r=b.createTextNode(this.prepareReplacementString(r,e,n,t));if(!r.data){return r}if(!o){return r}o.appendChild(r);return o},replaceMatch:function(e,n,t,r){var i=n.node;var a=r.node;var o;var c;if(i===a){var s=i;if(n.indexInNode>0){o=b.createTextNode(s.data.substring(0,n.indexInNode));s.parentNode.insertBefore(o,s)}var u=this.getPortionReplacementNode(r,e);s.parentNode.insertBefore(u,s);if(r.endIndexInNode<s.length){c=b.createTextNode(s.data.substring(r.endIndexInNode));s.parentNode.insertBefore(c,s)}s.parentNode.removeChild(s);this.reverts.push(function(){if(o===u.previousSibling){o.parentNode.removeChild(o)}if(c===u.nextSibling){c.parentNode.removeChild(c)}u.parentNode.replaceChild(s,u)});return u}else{o=b.createTextNode(i.data.substring(0,n.indexInNode));c=b.createTextNode(a.data.substring(r.endIndexInNode));var d=this.getPortionReplacementNode(n,e);var l=[];for(var h=0,f=t.length;h<f;++h){var p=t[h];var v=this.getPortionReplacementNode(p,e);p.node.parentNode.replaceChild(v,p.node);this.reverts.push(function(e,n){return function(){n.parentNode.replaceChild(e.node,n)}}(p,v));l.push(v)}var g=this.getPortionReplacementNode(r,e);i.parentNode.insertBefore(o,i);i.parentNode.insertBefore(d,i);i.parentNode.removeChild(i);a.parentNode.insertBefore(g,a);a.parentNode.insertBefore(c,a);a.parentNode.removeChild(a);this.reverts.push(function(){o.parentNode.removeChild(o);d.parentNode.replaceChild(i,d);c.parentNode.removeChild(c);g.parentNode.replaceChild(a,g)});return g}}};return c}());var r=function(){var e=h.create("div");e.appendChild(h.create("","0-"));e.appendChild(h.create("","2"));e.normalize();return e.firstChild.length!==2}();function i(e){return typeof e==="function"||e instanceof Element?e:undefined}function c(e){var n=e.index===0&&e.isEnd?"biaodian cjk":"biaodian cjk portion "+(e.index===0?"is-first":e.isEnd?"is-end":"is-inner");var t=h.create("h-char-group",n);t.innerHTML=e.text;return t}function f(e){var n=h.create("div");var t=e.charCodeAt(0).toString(16);n.innerHTML='<h-char unicode="'+t+'" class="biaodian cjk '+B(e)+'">'+e+"</h-char>";return n.firstChild}function B(e){return e.match(a.char.biaodian.open)?"bd-open":e.match(a.char.biaodian.close)?"bd-close bd-end":e.match(a.char.biaodian.end)?/(?:\u3001|\u3002|\uff0c)/i.test(e)?"bd-end bd-cop":"bd-end":e.match(new RegExp(M.biaodian.liga))?"bd-liga":e.match(new RegExp(M.biaodian.middle))?"bd-middle":""}h.extend(t.fn,{normalize:function(){if(r){this.context.normalize()}return this},jinzify:function(e){return this.filter(e||null).avoid("h-jinze").replace(a.jinze.touwei,function(e,n){var t=h.create("h-jinze","touwei");t.innerHTML=n[0];return e.index===0&&e.isEnd||e.index===1?t:""}).replace(a.jinze.wei,function(e,n){var t=h.create("h-jinze","wei");t.innerHTML=n[0];return e.index===0?t:""}).replace(a.jinze.tou,function(e,n){var t=h.create("h-jinze","tou");t.innerHTML=n[0];return e.index===0&&e.isEnd||e.index===1?t:""}).replace(a.jinze.middle,function(e,n){var t=h.create("h-jinze","middle");t.innerHTML=n[0];return e.index===0&&e.isEnd||e.index===1?t:""}).endAvoid().endFilter()},groupify:function(e){var e=h.extend({biaodian:false,hanzi:false,kana:false,eonmun:false,western:false},e||{});this.avoid("h-word, h-char-group");if(e.biaodian){this.replace(a.group.biaodian[0],c).replace(a.group.biaodian[1],c)}if(e.hanzi||e.cjk){this.wrap(a.group.hanzi,h.clone(h.create("h-char-group","hanzi cjk")))}if(e.western){this.wrap(a.group.western,h.clone(h.create("h-word","western")))}if(e.kana){this.wrap(a.group.kana,h.clone(h.create("h-char-group","kana")))}if(e.eonmun||e.hangul){this.wrap(a.group.eonmun,h.clone(h.create("h-word","eonmun hangul")))}this.endAvoid();return this},charify:function(e){var e=h.extend({avoid:true,biaodian:false,punct:false,hanzi:false,latin:false,ellinika:false,kirillica:false,kana:false,eonmun:false},e||{});if(e.avoid){this.avoid("h-char")}if(e.biaodian){this.replace(a.char.biaodian.all,i(e.biaodian)||function(e){return f(e.text)}).replace(a.char.biaodian.liga,i(e.biaodian)||function(e){return f(e.text)})}if(e.hanzi||e.cjk){this.wrap(a.char.hanzi,i(e.hanzi||e.cjk)||h.clone(h.create("h-char","hanzi cjk")))}if(e.punct){this.wrap(a.char.punct.all,i(e.punct)||h.clone(h.create("h-char","punct")))}if(e.latin){this.wrap(a.char.latin,i(e.latin)||h.clone(h.create("h-char","alphabet latin")))}if(e.ellinika||e.greek){this.wrap(a.char.ellinika,i(e.ellinika||e.greek)||h.clone(h.create("h-char","alphabet ellinika greek")))}if(e.kirillica||e.cyrillic){this.wrap(a.char.kirillica,i(e.kirillica||e.cyrillic)||h.clone(h.create("h-char","alphabet kirillica cyrillic")))}if(e.kana){this.wrap(a.char.kana,i(e.kana)||h.clone(h.create("h-char","kana")))}if(e.eonmun||e.hangul){this.wrap(a.char.eonmun,i(e.eonmun||e.hangul)||h.clone(h.create("h-char","eonmun hangul")))}this.endAvoid();return this}});h.extend(o,{isNodeNormalizeNormal:r,find:t,createBDGroup:c,createBDChar:f});h.matches=o.find.matches;void["setMode","wrap","replace","revert","addBoundary","removeBoundary","avoid","endAvoid","filter","endFilter","jinzify","groupify","charify"].forEach(function(e){o.fn[e]=function(){if(!this.finder){this.finder=o.find(this.context)}this.finder[e](arguments[0],arguments[1]);return this}});var p={};function v(e,n){var t=h.create("canvas");var r;t.width="50";t.height="20";t.style.display="none";l.appendChild(t);r=t.getContext("2d");r.textBaseline="top";r.font="15px "+n+", sans-serif";r.fillStyle="black";r.strokeStyle="black";r.fillText(e,0,0);return{node:t,context:r,remove:function(){h.remove(t,l)}}}function g(e,n){var t;var r=e.context;var i=n.context;try{for(var a=1;a<=20;a++){for(var o=1;o<=50;o++){if(typeof t==="undefined"&&r.getImageData(o,a,1,1).data[3]!==i.getImageData(o,a,1,1).data[3]){t=false;break}else if(typeof t==="boolean"){break}if(o===50&&a===20&&typeof t==="undefined"){t=true}}}e.remove();n.remove();e=null;n=null;return t}catch(e){}return false}function D(e,n,t){var e=e;var n=n||"sans-serif";var t=t||"辭Q";var r;n=v(t,n);e=v(t,e);return!g(e,n)}p.writeOnCanvas=v;p.compareCanvases=g;p.detectFont=D;p.support=function(){var i="Webkit Moz ms".split(" ");var a=h.create("h-test");function e(e){var n=e.charAt(0).toUpperCase()+e.slice(1);var t=(e+" "+i.join(n+" ")+n).split(" ");var r;t.forEach(function(e){if(typeof a.style[e]==="string"){r=true}});return r||false}function n(e,n){var t=l||h.create("body");var r=h.create("div");var i=l?r:t;var n=typeof n==="function"?n:function(){};var a,o,c;a=["<style>",e,"</style>"].join("");i.innerHTML+=a;t.appendChild(r);if(!l){t.style.background="";t.style.overflow="hidden";c=u.style.overflow;u.style.overflow="hidden";u.appendChild(t)}o=n(i,e);h.remove(i);if(!l){u.style.overflow=c}return!!o}function o(e,n){var t;if(s.getComputedStyle){t=d.defaultView.getComputedStyle(e,null).getPropertyValue(n)}else if(e.currentStyle){t=e.currentStyle[n]}return t}return{columnwidth:e("columnWidth"),fontface:function(){var a;n('@font-face { font-family: font; src: url("//"); }',function(e,n){var t=h.qsa("style",e)[0];var r=t.sheet||t.styleSheet;var i=r?r.cssRules&&r.cssRules[0]?r.cssRules[0].cssText:r.cssText||"":"";a=/src/i.test(i)&&i.indexOf(n.split(" ")[0])===0});return a}(),ruby:function(){var e=h.create("ruby");var n=h.create("rt");var t=h.create("rp");var r;e.appendChild(t);e.appendChild(n);u.appendChild(e);r=o(t,"display")==="none"||o(e,"display")==="ruby"&&o(n,"display")==="ruby-text"?true:false;u.removeChild(e);e=null;n=null;t=null;return r}(),"ruby-display":function(){var e=h.create("div");e.innerHTML='<h-test-a style="display: ruby;"></h-test-a><h-test-b style="display: ruby-text-container;"></h-test-b>';return e.querySelector("h-test-a").style.display==="ruby"&&e.querySelector("h-test-b").style.display==="ruby-text-container"}(),"ruby-interchar":function(){var e="inter-character";var n=h.create("div");var t;n.innerHTML='<h-test style="-moz-ruby-position:'+e+";-ms-ruby-position:"+e+";-webkit-ruby-position:"+e+";ruby-position:"+e+';"></h-test>';t=n.querySelector("h-test").style;return t.rubyPosition===e||t.WebkitRubyPosition===e||t.MozRubyPosition===e||t.msRubyPosition===e}(),textemphasis:e("textEmphasis"),unicoderange:function(){var e;n('@font-face{font-family:test-for-unicode-range;src:local(Arial),local("Droid Sans")}@font-face{font-family:test-for-unicode-range;src:local("Times New Roman"),local(Times),local("Droid Serif");unicode-range:U+270C}',function(){e=!p.detectFont("test-for-unicode-range",'Arial, "Droid Sans"',"Q")});return e}(),writingmode:e("writingMode")}}();p.initCond=function(e){var e=e||u;var n="";var t;for(var r in p.support){t=(p.support[r]?"":"no-")+r;e.classList.add(t);n+=t+" "}return n};var F=p.support["ruby-interchar"];function b(e){var n=h.create("!");var i=e.classList;var t,a;n.appendChild(h.clone(e));h.tag("rt",n.firstChild).forEach(function(e){var n=h.create("!");var t=[];var r;do{r=(r||e).previousSibling;if(!r||r.nodeName.match(/((?:h\-)?r[ubt])/i))break;n.insertBefore(h.clone(r),n.firstChild);t.push(r)}while(!r.nodeName.match(/((?:h\-)?r[ubt])/i));a=i.contains("zhuyin")?N(n,e):w(n,e);try{e.parentNode.replaceChild(a,e);t.map(h.remove)}catch(e){}});return x(n)}function m(e){var n=h.create("!");n.appendChild(h.clone(e));h.tag("rt",n.firstChild).forEach(function(e){var n=h.create("!");var t=[];var r,i;do{r=(r||e).previousSibling;if(!r||r.nodeName.match(/((?:h\-)?r[ubt])/i))break;n.insertBefore(h.clone(r),n.firstChild);t.push(r)}while(!r.nodeName.match(/((?:h\-)?r[ubt])/i));i=h.create("rt");i.innerHTML=C(e);e.parentNode.replaceChild(i,e)});return n.firstChild}function y(e){var n=h.create("!");var s=e.classList;var t,r,u,d;n.appendChild(h.clone(e));t=n.firstChild;r=u=h.tag("rb",t);d=r.length;void function(e){if(!e)return;u=h.tag("rt",e).map(function(e,n){if(!r[n])return;var t=N(r[n],e);try{r[n].parentNode.replaceChild(t,r[n])}catch(e){}return t});h.remove(e);t.setAttribute("rightangle","true")}(t.querySelector("rtc.zhuyin"));h.qsa("rtc:not(.zhuyin)",t).forEach(function(e,c){var n;n=h.tag("rt",e).map(function(e,n){var t=Number(e.getAttribute("rbspan")||1);var r=0;var i=[];var a,o;if(t>d)t=d;do{try{a=u.shift();i.push(a)}catch(e){}if(typeof a==="undefined")break;r+=Number(a.getAttribute("span")||1)}while(t>r);if(t<r){if(i.length>1){console.error("An impossible `rbspan` value detected.",ruby);return}i=h.tag("rb",i[0]);u=i.slice(t).concat(u);i=i.slice(0,t);r=t}o=w(i,e,{class:s,span:r,order:c});try{i[0].parentNode.replaceChild(o,i.shift());i.map(h.remove)}catch(e){}return o});u=n;if(c===1)t.setAttribute("doubleline","true");h.remove(e)});return x(n)}function x(e){var n=e.firstChild;var t=h.create("h-ruby");t.innerHTML=n.innerHTML;h.setAttr(t,n.attributes);t.normalize();return t}function E(e){if(!e instanceof Element)return e;var n=e.classList;if(n.contains("pinyin"))n.add("romanization");else if(n.contains("romanization"))n.add("annotation");else if(n.contains("mps"))n.add("zhuyin");else if(n.contains("rightangle"))n.add("complex");return e}function w(e,n,t){var r=h.create("h-ru");var n=h.clone(n);var t=t||{};t.annotation="true";if(Array.isArray(e)){r.innerHTML=e.map(function(e){if(typeof e==="undefined")return"";return e.outerHTML}).join("")+n.outerHTML}else{r.appendChild(h.clone(e));r.appendChild(n)}h.setAttr(r,t);return r}function N(e,n){var e=h.clone(e);var t=h.create("h-ru");t.setAttribute("zhuyin",true);t.appendChild(e);t.innerHTML+=C(n);return t}function C(e){var n=typeof e==="string"?e:e.textContent;var t,r,i;t=n.replace(a.zhuyin.diao,"");i=t?t.length:0;r=n.replace(t,"").replace(/[\u02C5]/g,"ˇ").replace(/[\u030D]/g,"͘");return i===0?"":'<h-zhuyin length="'+i+'" diao="'+r+'"><h-yin>'+t+"</h-yin><h-diao>"+r+"</h-diao></h-zhuyin>"}h.extend(p,{renderRuby:function(e,n){var n=n||"ruby";var t=h.qsa(n,e);h.qsa("rtc",e).concat(t).map(E);t.forEach(function(e){var n=e.classList;var t;if(n.contains("complex"))t=y(e);else if(n.contains("zhuyin"))t=F?m(e):b(e);if(t)e.parentNode.replaceChild(t,e)})},simplifyRubyClass:E,getZhuyinHTML:C,renderComplexRuby:y,renderSimpleRuby:b,renderInterCharRuby:m});h.extend(p,{renderElem:function(e){this.renderRuby(e);this.renderDecoLine(e);this.renderDecoLine(e,"s, del");this.renderEm(e)},renderDecoLine:function(e,n){var t=h.qsa(n||"u, ins",e);var r=t.length;e:while(r--){var i=t[r];var a=null;n:do{a=(a||i).previousSibling;if(!a){continue e}else if(t[r-1]===a){i.classList.add("adjacent")}}while(h.isIgnorable(a))}},renderEm:function(e,n){var t=n?"qsa":"tag";var n=n||"em";var r=h[t](n,e);r.forEach(function(e){var n=o(e);if(p.support.textemphasis){n.avoid("rt, h-char").charify({biaodian:true,punct:true})}else{n.avoid("rt, h-char, h-char-group").jinzify().groupify({western:true}).charify({hanzi:true,biaodian:true,punct:true,latin:true,ellinika:true,kirillica:true})}})}});o.normalize=p;o.localize=p;o.support=p.support;o.detectFont=p.detectFont;o.fn.initCond=function(){this.condition.classList.add("han-js-rendered");o.normalize.initCond(this.condition);return this};void["Elem","DecoLine","Em","Ruby"].forEach(function(e){var n="render"+e;o.fn[n]=function(e){o.normalize[n](this.context,e);return this}});h.extend(o.support,{heiti:true,songti:o.detectFont('"Han Songti"'),"songti-gb":o.detectFont('"Han Songti GB"'),kaiti:o.detectFont('"Han Kaiti"'),fangsong:o.detectFont('"Han Fangsong"')});o.correctBiaodian=function(e){var e=e||d;var n=o.find(e);n.avoid("h-char").replace(/([‘“])/g,function(e){var n=o.createBDChar(e.text);n.classList.add("bd-open","punct");return n}).replace(/([’”])/g,function(e){var n=o.createBDChar(e.text);n.classList.add("bd-close","bd-end","punct");return n});return o.support.unicoderange?n:n.charify({biaodian:true})};o.correctBasicBD=o.correctBiaodian;o.correctBD=o.correctBiaodian;h.extend(o.fn,{biaodian:null,correctBiaodian:function(){this.biaodian=o.correctBiaodian(this.context);return this},revertCorrectedBiaodian:function(){try{this.biaodian.revert("all")}catch(e){}return this}});o.fn.correctBasicBD=o.fn.correctBiaodian;o.fn.revertBasicBD=o.fn.revertCorrectedBiaodian;var T="<<hws>>";var S=h.create("h-hws");S.setAttribute("hidden","");S.innerHTML=" ";function q(e,n){return e&&n&&e.parentNode===n.parentNode}function U(e,n){var t=e;var n=n||"";if(h.isElmt(e.nextSibling)||q(e,e.nextSibling)){return n+T}else{while(!t.nextSibling){t=t.parentNode}if(e!==t){t.insertAdjacentHTML("afterEnd","<h-hws hidden> </h-hws>")}}return n}function L(e,n){return e.isEnd&&e.index===0?n[1]+T+n[2]:e.index===0?U(e.node,e.text):e.text}function _(e){return e.index===0?h.clone(S):""}var k;function Y(e){var n=e.node.parentNode;if(e.index===0){k=e.endIndexInNode-2}if(n.nodeName.toLowerCase()==="h-hws"&&(e.index===1||e.indexInMatch===k)){n.classList.add("quote-inner")}return e.text}function W(e){var n=e.node.parentNode;if(n.nodeName.toLowerCase()==="h-hws"){n.classList.add("quote-outer")}return e.text}h.extend(o,{renderHWS:function(e,n){var t=n?"textarea, code, kbd, samp, pre":"textarea";var r=n?"strict":"base";var e=e||d;var i=o.find(e);i.avoid(t).replace(o.TYPESET.hws[r][0],L).replace(o.TYPESET.hws[r][1],L).replace(new RegExp("("+T+")+","g"),_).replace(/([\'"])\s(.+?)\s\1/g,Y).replace(/\s[‘“]/g,W).replace(/[’”]\s/g,W).normalize();return i}});h.extend(o.fn,{renderHWS:function(e){o.renderHWS(this.context,e);return this},revertHWS:function(){h.tag("h-hws",this.context).forEach(function(e){h.remove(e)});this.HWS=[];return this}});var V="bd-hangable";var Z="h-char.bd-hangable";var $='<h-cs hidden class="jinze-outer hangable-outer"> </h-cs>';var z=o.find.matches;function I(){var e=h.create("div");var n;e.innerHTML="<span>a b</span><span style=\"font-family: 'Han Space'\">a b</span>";l.appendChild(e);n=e.firstChild.offsetWidth!==e.lastChild.offsetWidth;h.remove(e);return n}function J(e){var n=e.nextSibling;if(n&&z(n,"h-cs.jinze-outer")){n.classList.add("hangable-outer")}else{e.insertAdjacentHTML("afterend",$)}}o.support["han-space"]=I();h.extend(o,{detectSpaceFont:I,isSpaceFontLoaded:I(),renderHanging:function(e){var e=e||d;var n=o.find(e);n.avoid("textarea, code, kbd, samp, pre").avoid(Z).replace(a.jinze.hanging,function(e){if(/^[\x20\t\r\n\f]+$/.test(e.text)){return""}var n=e.node.parentNode;var t,r,i,a;if(t=h.parent(n,"h-jinze")){J(t)}a=e.text.trim();r=o.createBDChar(a);r.innerHTML="<h-inner>"+a+"</h-inner>";r.classList.add(V);i=h.parent(n,"h-char.biaodian");return!i?r:function(){i.classList.add(V);return z(n,"h-inner, h-inner *")?a:r.firstChild}()});return n}});h.extend(o.fn,{renderHanging:function(){var e=this.condition.classList;o.isSpaceFontLoaded=I();if(o.isSpaceFontLoaded&&e.contains("no-han-space")){e.remove("no-han-space");e.add("han-space")}o.renderHanging(this.context);return this},revertHanging:function(){h.qsa("h-char.bd-hangable, h-cs.hangable-outer",this.context).forEach(function(e){var n=e.classList;n.remove("bd-hangable");n.remove("hangable-outer")});return this}});var G="bd-jiya";var K="h-char.bd-jiya";var Q="bd-consecutive";var X='<h-cs hidden class="jinze-outer jiya-outer"> </h-cs>';var z=o.find.matches;function ee(e){return e.replace(/(biaodian|cjk|bd-jiya|bd-consecutive|bd-hangable)/gi,"").trim()}function ne(e){var n=e.text;var t=e.node.parentNode;var r=h.parent(t,"h-char.biaodian");var i=o.createBDChar(n);var a;i.innerHTML="<h-inner>"+n+"</h-inner>";i.classList.add(G);if(a=h.parent(t,"h-jinze")){re(a)}return!r?i:function(){r.classList.add(G);return z(t,"h-inner, h-inner *")?n:i.firstChild}()}var R,j;function te(e){var n=R;var t=e.node.parentNode;var r=h.parent(t,"h-char.biaodian");var i=h.parent(r,"h-jinze");var a;a=r.classList;if(n){r.setAttribute("prev",n)}if(j&&a.contains("bd-open")){j.pop().setAttribute("next","bd-open")}j=undefined;if(e.isEnd){R=undefined;a.add(Q,"end-portion")}else{R=ee(r.getAttribute("class"));a.add(Q)}if(i){j=ie(i,{prev:n,class:ee(r.getAttribute("class"))})}return e.text}function re(e){if(z(e,".tou, .touwei")&&!z(e.previousSibling,"h-cs.jiya-outer")){e.insertAdjacentHTML("beforebegin",X)}if(z(e,".wei, .touwei")&&!z(e.nextSibling,"h-cs.jiya-outer")){e.insertAdjacentHTML("afterend",X)}}function ie(e,n){var t,r;if(z(e,".tou, .touwei")){t=e.previousSibling;if(z(t,"h-cs")){t.className="jinze-outer jiya-outer";t.setAttribute("prev",n.prev)}}if(z(e,".wei, .touwei")){r=e.nextSibling;if(z(r,"h-cs")){r.className="jinze-outer jiya-outer "+n["class"];r.removeAttribute("prev")}}return[t,r]}o.renderJiya=function(e){var e=e||d;var n=o.find(e);n.avoid("textarea, code, kbd, samp, pre, h-cs").avoid(K).charify({avoid:false,biaodian:ne}).endAvoid().avoid("textarea, code, kbd, samp, pre, h-cs").replace(a.group.biaodian[0],te).replace(a.group.biaodian[1],te);return n};h.extend(o.fn,{renderJiya:function(){o.renderJiya(this.context);return this},revertJiya:function(){h.qsa("h-char.bd-jiya, h-cs.jiya-outer",this.context).forEach(function(e){var n=e.classList;n.remove("bd-jiya");n.remove("jiya-outer")});return this}});var ae="h-ru[annotation]";var oe="textarea, code, kbd, samp, pre";function A(t,r,i){return function(){var e=o.localize.writeOnCanvas(r,t);var n=o.localize.writeOnCanvas(i,t);return o.localize.compareCanvases(e,n)}}function ce(){return A('"Romanization Sans"',"a̍","󰁡")}function se(){return A('"Romanization Sans"',"i̍","󰁩")}function ue(){return A('"Zhuyin Kaiti"',"ㆴ͘","󳆴")}function P(t){return function(e){var e=e||d;var n=o.find(e).avoid(oe);t.forEach(function(r){n.replace(new RegExp(r[0],"ig"),function(e,n){var t=h.clone(de);t.innerHTML="<h-inner>"+n[0]+"</h-inner>";t.setAttribute("display-as",r[1]);return e.index===0?t:""})});return n}}var de=h.create("h-char","comb-liga");h.extend(o,{isVowelCombLigaNormal:ce(),isVowelICombLigaNormal:se(),isZhuyinCombLigaNormal:ue(),isCombLigaNormal:se()(),substVowelCombLiga:P(o.TYPESET["display-as"]["comb-liga-vowel"]),substZhuyinCombLiga:P(o.TYPESET["display-as"]["comb-liga-zhuyin"]),substCombLigaWithPUA:P(o.TYPESET["display-as"]["comb-liga-pua"]),substInaccurateChar:function(e){var e=e||d;var n=o.find(e);n.avoid(oe);o.TYPESET["inaccurate-char"].forEach(function(e){n.replace(new RegExp(e[0],"ig"),e[1])})}});h.extend(o.fn,{"comb-liga-vowel":null,"comb-liga-vowel-i":null,"comb-liga-zhuyin":null,"inaccurate-char":null,substVowelCombLiga:function(){this["comb-liga-vowel"]=o.substVowelCombLiga(this.context);return this},substVowelICombLiga:function(){this["comb-liga-vowel-i"]=o.substVowelICombLiga(this.context);return this},substZhuyinCombLiga:function(){this["comb-liga-zhuyin"]=o.substZhuyinCombLiga(this.context);return this},substCombLigaWithPUA:function(){if(!o.isVowelCombLigaNormal()){this["comb-liga-vowel"]=o.substVowelCombLiga(this.context)}else if(!o.isVowelICombLigaNormal()){this["comb-liga-vowel-i"]=o.substVowelICombLiga(this.context)}if(!o.isZhuyinCombLigaNormal()){this["comb-liga-zhuyin"]=o.substZhuyinCombLiga(this.context)}return this},revertVowelCombLiga:function(){try{this["comb-liga-vowel"].revert("all")}catch(e){}return this},revertVowelICombLiga:function(){try{this["comb-liga-vowel-i"].revert("all")}catch(e){}return this},revertZhuyinCombLiga:function(){try{this["comb-liga-zhuyin"].revert("all")}catch(e){}return this},revertCombLigaWithPUA:function(){try{this["comb-liga-vowel"].revert("all");this["comb-liga-vowel-i"].revert("all");this["comb-liga-zhuyin"].revert("all")}catch(e){}return this},substInaccurateChar:function(){this["inaccurate-char"]=o.substInaccurateChar(this.context);return this},revertInaccurateChar:function(){try{this["inaccurate-char"].revert("all")}catch(e){}return this}});s.addEventListener("DOMContentLoaded",function(){var e;if(u.classList.contains("han-init")){o.init()}else if(e=d.querySelector(".han-init-context")){o.init=o(e).render()}});if(typeof e==="undefined"||e===false){s.Han=o}return o});