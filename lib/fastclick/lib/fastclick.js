(function(){"use strict";function u(i,e){var t;e=e||{};this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=e.touchBoundary||10;this.layer=i;this.tapDelay=e.tapDelay||200;this.tapTimeout=e.tapTimeout||700;if(u.notNeeded(i)){return}function n(e,t){return function(){return e.apply(t,arguments)}}var r=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"];var o=this;for(var a=0,s=r.length;a<s;a++){o[r[a]]=n(o[r[a]],o)}if(c){i.addEventListener("mouseover",this.onMouse,true);i.addEventListener("mousedown",this.onMouse,true);i.addEventListener("mouseup",this.onMouse,true)}i.addEventListener("click",this.onClick,true);i.addEventListener("touchstart",this.onTouchStart,false);i.addEventListener("touchmove",this.onTouchMove,false);i.addEventListener("touchend",this.onTouchEnd,false);i.addEventListener("touchcancel",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){i.removeEventListener=function(e,t,n){var r=Node.prototype.removeEventListener;if(e==="click"){r.call(i,e,t.hijacked||t,n)}else{r.call(i,e,t,n)}};i.addEventListener=function(e,t,n){var r=Node.prototype.addEventListener;if(e==="click"){r.call(i,e,t.hijacked||(t.hijacked=function(e){if(!e.propagationStopped){t(e)}}),n)}else{r.call(i,e,t,n)}}}if(typeof i.onclick==="function"){t=i.onclick;i.addEventListener("click",function(e){t(e)},false);i.onclick=null}}var e=navigator.userAgent.indexOf("Windows Phone")>=0;var c=navigator.userAgent.indexOf("Android")>0&&!e;var s=/iP(ad|hone|od)/.test(navigator.userAgent)&&!e;var l=s&&/OS 4_\d(_\d)?/.test(navigator.userAgent);var f=s&&/OS [6-7]_\d/.test(navigator.userAgent);var o=navigator.userAgent.indexOf("BB10")>0;u.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled){return true}break;case"input":if(s&&e.type==="file"||e.disabled){return true}break;case"label":case"iframe":case"video":return true}return/\bneedsclick\b/.test(e.className)};u.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return true;case"select":return!c;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return false}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}};u.prototype.sendClick=function(e,t){var n,r;if(document.activeElement&&document.activeElement!==e){document.activeElement.blur()}r=t.changedTouches[0];n=document.createEvent("MouseEvents");n.initMouseEvent(this.determineEventType(e),true,true,window,1,r.screenX,r.screenY,r.clientX,r.clientY,false,false,false,false,0,null);n.forwardedTouchEvent=true;e.dispatchEvent(n)};u.prototype.determineEventType=function(e){if(c&&e.tagName.toLowerCase()==="select"){return"mousedown"}return"click"};u.prototype.focus=function(e){var t;if(s&&e.setSelectionRange&&e.type.indexOf("date")!==0&&e.type!=="time"&&e.type!=="month"){t=e.value.length;e.setSelectionRange(t,t)}else{e.focus()}};u.prototype.updateScrollParent=function(e){var t,n;t=e.fastClickScrollParent;if(!t||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n;e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}if(t){t.fastClickLastScrollTop=t.scrollTop}};u.prototype.getTargetElementFromEventTarget=function(e){if(e.nodeType===Node.TEXT_NODE){return e.parentNode}return e};u.prototype.onTouchStart=function(e){var t,n,r;if(e.targetTouches.length>1){return true}t=this.getTargetElementFromEventTarget(e.target);n=e.targetTouches[0];if(s){r=window.getSelection();if(r.rangeCount&&!r.isCollapsed){return true}if(!l){if(n.identifier&&n.identifier===this.lastTouchIdentifier){e.preventDefault();return false}this.lastTouchIdentifier=n.identifier;this.updateScrollParent(t)}}this.trackingClick=true;this.trackingClickStart=e.timeStamp;this.targetElement=t;this.touchStartX=n.pageX;this.touchStartY=n.pageY;if(e.timeStamp-this.lastClickTime<this.tapDelay){e.preventDefault()}return true};u.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;if(Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n){return true}return false};u.prototype.onTouchMove=function(e){if(!this.trackingClick){return true}if(this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e)){this.trackingClick=false;this.targetElement=null}return true};u.prototype.findControl=function(e){if(e.control!==undefined){return e.control}if(e.htmlFor){return document.getElementById(e.htmlFor)}return e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};u.prototype.onTouchEnd=function(e){var t,n,r,i,o,a=this.targetElement;if(!this.trackingClick){return true}if(e.timeStamp-this.lastClickTime<this.tapDelay){this.cancelNextClick=true;return true}if(e.timeStamp-this.trackingClickStart>this.tapTimeout){return true}this.cancelNextClick=false;this.lastClickTime=e.timeStamp;n=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(f){o=e.changedTouches[0];a=document.elementFromPoint(o.pageX-window.pageXOffset,o.pageY-window.pageYOffset)||a;a.fastClickScrollParent=this.targetElement.fastClickScrollParent}r=a.tagName.toLowerCase();if(r==="label"){t=this.findControl(a);if(t){this.focus(a);if(c){return false}a=t}}else if(this.needsFocus(a)){if(e.timeStamp-n>100||s&&window.top!==window&&r==="input"){this.targetElement=null;return false}this.focus(a);this.sendClick(a,e);if(!s||r!=="select"){this.targetElement=null;e.preventDefault()}return false}if(s&&!l){i=a.fastClickScrollParent;if(i&&i.fastClickLastScrollTop!==i.scrollTop){return true}}if(!this.needsClick(a)){e.preventDefault();this.sendClick(a,e)}return false};u.prototype.onTouchCancel=function(){this.trackingClick=false;this.targetElement=null};u.prototype.onMouse=function(e){if(!this.targetElement){return true}if(e.forwardedTouchEvent){return true}if(!e.cancelable){return true}if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(e.stopImmediatePropagation){e.stopImmediatePropagation()}else{e.propagationStopped=true}e.stopPropagation();e.preventDefault();return false}return true};u.prototype.onClick=function(e){var t;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true}if(e.target.type==="submit"&&e.detail===0){return true}t=this.onMouse(e);if(!t){this.targetElement=null}return t};u.prototype.destroy=function(){var e=this.layer;if(c){e.removeEventListener("mouseover",this.onMouse,true);e.removeEventListener("mousedown",this.onMouse,true);e.removeEventListener("mouseup",this.onMouse,true)}e.removeEventListener("click",this.onClick,true);e.removeEventListener("touchstart",this.onTouchStart,false);e.removeEventListener("touchmove",this.onTouchMove,false);e.removeEventListener("touchend",this.onTouchEnd,false);e.removeEventListener("touchcancel",this.onTouchCancel,false)};u.notNeeded=function(e){var t;var n;var r;var i;if(typeof window.ontouchstart==="undefined"){return true}n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(n){if(c){t=document.querySelector("meta[name=viewport]");if(t){if(t.content.indexOf("user-scalable=no")!==-1){return true}if(n>31&&document.documentElement.scrollWidth<=window.outerWidth){return true}}}else{return true}}if(o){r=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);if(r[1]>=10&&r[2]>=3){t=document.querySelector("meta[name=viewport]");if(t){if(t.content.indexOf("user-scalable=no")!==-1){return true}if(document.documentElement.scrollWidth<=window.outerWidth){return true}}}}if(e.style.msTouchAction==="none"||e.style.touchAction==="manipulation"){return true}i=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(i>=27){t=document.querySelector("meta[name=viewport]");if(t&&(t.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth)){return true}}if(e.style.touchAction==="none"||e.style.touchAction==="manipulation"){return true}return false};u.attach=function(e,t){return new u(e,t)};if(typeof define==="function"&&typeof define.amd==="object"&&define.amd){define(function(){return u})}else if(typeof module!=="undefined"&&module.exports){module.exports=u.attach;module.exports.FastClick=u}else{window.FastClick=u}})();