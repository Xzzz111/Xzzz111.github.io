(function(){function d(e,o){if(typeof o=="string"){var t=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;if(!!t){while(e){if(t.bind(e)(o)){return e}else{e=e.parentElement}}}return false}else{while(e){if(e==o){return e}else{e=e.parentElement}}return false}}window.needShareButton=function(e,o){var s=this;s.elem=e||"need-share-button";s.getTitle=function(){var e;if(document.querySelector){e=document.querySelector("title");if(e){return e.innerText}}return document.title};s.getImage=function(){var e;if(document.querySelector){e=document.querySelector('meta[property="og:image"]')||document.querySelector('meta[name="twitter:image"]');if(e){return e.getAttribute("content")}else{return""}}else{return""}};s.getDescription=function(){var e;if(document.querySelector){e=document.querySelector('meta[property="og:description"]')||document.querySelector('meta[name="twitter:description"]')||document.querySelector('meta[name="description"]');if(e){return e.getAttribute("content")}else{return""}}else{e=document.getElementsByTagName("meta").namedItem("description");if(e){return e.getAttribute("content")}else{return""}}};s.share={weibo:function(e){var o=p(e);var t="http://v.t.sina.com.cn/share/share.php?title="+encodeURIComponent(o.title)+"&url="+encodeURIComponent(o.url)+"&pic="+encodeURIComponent(o.image);s.popup(t)},wechat:function(e){var o=p(e);var t="https://api.qinco.me/api/qr?size=400&content="+encodeURIComponent(o.url);var n=e.querySelector(".need-share-button_dropdown");var r=n.getElementsByClassName("need-share-wechat-code-image")[0];if(r){r.remove()}else{r=document.createElement("img");r.src=t;r.alt="loading wechat image...";r.setAttribute("class","need-share-wechat-code-image");n.appendChild(r)}},douban:function(e){var o=p(e);var t="https://www.douban.com/share/service?name="+encodeURIComponent(o.title)+"&href="+encodeURIComponent(o.url)+"&image="+encodeURIComponent(o.image);s.popup(t)},qqzone:function(e){var o=p(e);var t="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?title="+encodeURIComponent(o.title)+"&url="+encodeURIComponent(o.url)+"&pics="+encodeURIComponent(o.image)+"&desc="+encodeURIComponent(o.description);s.popup(t)},renren:function(e){var o=p(e);var t="http://widget.renren.com/dialog/share?title="+encodeURIComponent(o.title)+"&resourceUrl="+encodeURIComponent(o.url)+"&pic="+encodeURIComponent(o.image)+"&description="+encodeURIComponent(o.description);s.popup(t)},mailto:function(e){var o=p(e);var t="mailto:?subject="+encodeURIComponent(o.title)+"&body=Thought you might enjoy reading this: "+encodeURIComponent(o.url)+" - "+encodeURIComponent(o.description);window.location.href=t},twitter:function(e){var o=p(e);var t=o.protocol+"twitter.com/intent/tweet?text=";t+=encodeURIComponent(o.title)+"&url="+encodeURIComponent(o.url);s.popup(t)},pinterest:function(e){var o=p(e);var t=o.protocol+"pinterest.com/pin/create/bookmarklet/?is_video=false";t+="&media="+encodeURIComponent(o.image);t+="&url="+encodeURIComponent(o.url);t+="&description="+encodeURIComponent(o.title);s.popup(t)},facebook:function(e){var o=p(e);var t=o.protocol+"www.facebook.com/share.php?";t+="u="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);s.popup(t)},googleplus:function(e){var o=p(e);var t=o.protocol+"plus.google.com/share?";t+="url="+encodeURIComponent(o.url);s.popup(t)},reddit:function(e){var o=p(e);var t=o.protocol+"www.reddit.com/submit?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);s.popup(t)},delicious:function(e){var o=p(e);var t=o.protocol+"del.icio.us/post?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);t+="&notes="+encodeURIComponent(o.description);s.popup(t)},stumbleupon:function(e){var o=p(e);var t=o.protocol+"www.stumbleupon.com/submit?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);s.popup(t)},linkedin:function(e){var o=p(e);var t=o.protocol+"www.linkedin.com/shareArticle?mini=true";t+="&url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);t+="&source="+encodeURIComponent(o.source);s.popup(t)},slashdot:function(e){var o=p(e);var t=o.protocol+"slashdot.org/bookmark.pl?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);s.popup(t)},technorati:function(e){var o=p(e);var t=o.protocol+"technorati.com/faves?";t+="add="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);s.popup(t)},posterous:function(e){var o=p(e);var t=o.protocol+"posterous.com/share?";t+="linkto="+encodeURIComponent(o.url);s.popup(t)},tumblr:function(e){var o=p(e);var t=o.protocol+"www.tumblr.com/share?v=3";t+="&u="+encodeURIComponent(o.url);t+="&t="+encodeURIComponent(o.title);s.popup(t)},googlebookmarks:function(e){var o=p(e);var t=o.protocol+"www.google.com/bookmarks/mark?op=edit";t+="&bkmk="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);t+="&annotation="+encodeURIComponent(o.description);s.popup(t)},newsvine:function(e){var o=p(e);var t=o.protocol+"www.newsvine.com/_tools/seed&save?";t+="u="+encodeURIComponent(o.url);t+="&h="+encodeURIComponent(o.title);s.popup(t)},evernote:function(e){var o=p(e);var t=o.protocol+"www.evernote.com/clip.action?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);s.popup(t)},friendfeed:function(e){var o=p(e);var t=o.protocol+"www.friendfeed.com/share?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);s.popup(t)},vkontakte:function(e){var o=p(e);var t=o.protocol+"vkontakte.ru/share.php?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);t+="&description="+encodeURIComponent(o.description);t+="&image="+encodeURIComponent(o.image);t+="&noparse=true";s.popup(t)},odnoklassniki:function(e){var o=p(e);var t=o.protocol+"www.odnoklassniki.ru/dk?st.cmd=addShare&st.s=1";t+="&st.comments="+encodeURIComponent(o.description);t+="&st._surl="+encodeURIComponent(o.url);s.popup(t)},mailru:function(e){var o=p(e);var t=o.protocol+"connect.mail.ru/share?";t+="url="+encodeURIComponent(o.url);t+="&title="+encodeURIComponent(o.title);t+="&description="+encodeURIComponent(o.description);t+="&imageurl="+encodeURIComponent(o.image);s.popup(t)}};s.popup=function(e){var o=600,t=500,n=window.screenLeft!==undefined?window.screenLeft:screen.left,r=window.screenTop!==undefined?window.screenTop:screen.top,i=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,a=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,c=i/2-o/2+n,s=a/2-t/2+r,p=window.open(e,"targetWindow","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width="+o+", height="+t+", top="+s+", left="+c);if(window.focus){p.focus()}};s.options={iconStyle:"default",boxForm:"horizontal",position:"bottomCenter",protocol:["http","https"].indexOf(window.location.href.split(":")[0])===-1?"https://":"//",networks:"Weibo,Wechat,Douban,QQZone,Twitter,Pinterest,Facebook,GooglePlus,Reddit,Linkedin,Tumblr,Evernote"};for(var t in o){if(o.hasOwnProperty(t)){s.options[t]=o[t]}}s.options.networks=s.options.networks.split(",");function p(e){var o={};for(var t in s.options){if(s.options.hasOwnProperty(t)){o[t]=s.options[t]}}o.url=window.location.href;o.title=s.getTitle();o.image=s.getImage();o.description=s.getDescription();for(var n in e.dataset){if(n.match(/share/)){var r=n.replace(/share/,"");if(!r.length){continue}r=r.charAt(0).toLowerCase()+r.slice(1);var i=e.dataset[n];if(r==="networks"){i=i.split(",")}else if(r==="url"&&i&&i[0]==="/"){i=location.origin+i}o[r]=i}}return o}function n(o){var e=document.createElement("span");e.className="need-share-button_dropdown";if(o.querySelector(".need-share-button_dropdown")){return}var t=p(o);if(t.iconStyle=="box"&&t.boxForm=="horizontal"){e.className+=" need-share-button_dropdown-box-horizontal"}else if(t.iconStyle=="box"&&t.boxForm=="vertical"){e.className+=" need-share-button_dropdown-box-vertical"}setTimeout(function(){switch(t.position){case"topLeft":e.className+=" need-share-button_dropdown-top-left";break;case"topRight":e.className+=" need-share-button_dropdown-top-right";break;case"topCenter":e.className+=" need-share-button_dropdown-top-center";e.style.marginLeft=-e.offsetWidth/2+"px";break;case"middleLeft":e.className+=" need-share-button_dropdown-middle-left";e.style.marginTop=-e.offsetHeight/2+"px";break;case"middleRight":e.className+=" need-share-button_dropdown-middle-right";e.style.marginTop=-e.offsetHeight/2+"px";break;case"bottomLeft":e.className+=" need-share-button_dropdown-bottom-left";break;case"bottomRight":e.className+=" need-share-button_dropdown-bottom-right";break;case"bottomCenter":e.className+=" need-share-button_dropdown-bottom-center";e.style.marginLeft=-e.offsetWidth/2+"px";break;default:e.className+=" need-share-button_dropdown-bottom-center";e.style.marginLeft=-e.offsetWidth/2+"px";break}},1);var n=t.iconStyle=="default"?"need-share-button_link need-share-button_":"need-share-button_link-"+t.iconStyle+" need-share-button_link need-share-button_";for(var r in t.networks){if(t.networks.hasOwnProperty(r)){var i=document.createElement("span");r=t.networks[r].trim();var a=r.toLowerCase();i.className=n+a;var c=["weibo","wechat","douban","qqzone","renren"];if(c.indexOf(a)===-1){i.className+=" social-"+a}else{i.className+=" icon-"+a}i.dataset.network=a;i.title=r;e.appendChild(i)}}e.addEventListener("click",function(e){if(d(e.target,".need-share-button_link")){e.preventDefault();e.stopPropagation();s.share[e.target.dataset.network](o);return false}});o.appendChild(e)}document.addEventListener("click",function(e){var o=document.querySelector(".need-share-button-opened");if(!d(e.target,".need-share-button-opened")){if(o){o.classList.remove("need-share-button-opened");if(o.querySelector(".need-share-wechat-code-image")){o.querySelector(".need-share-wechat-code-image").remove()}}else{var t=d(e.target,s.elem);if(t){if(!t.classList.contains("need-share-button-opened")){n(t);setTimeout(function(){t.classList.add("need-share-button-opened")},1)}}}}else{setTimeout(function(){o.classList.remove("need-share-button-opened");if(o.querySelector(".need-share-wechat-code-image")){o.querySelector(".need-share-wechat-code-image").remove()}},1)}})}})();